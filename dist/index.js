import U from"underscore";import"jquery";var f=class a{static guid(){let e=()=>Math.floor((1+Math.random())*65536).toString(16).substring(1);return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}static namespacedGuid(e){return`${e}-${a.guid()}`}static getData(e,t){return e!==null?$(e).data(t):null}static findParentTag(e,t){return a.findParentByTag(e,t)}static findParentByTag(e,t){for(;e&&e.tagName!==t.toUpperCase()&&e.tagName!==null;)e=e.parentNode;return e}static findParentByMatch(e,t){for(;e&&e.tagName!==null;){if(e.matches&&e.matches(t))return e;e=e.parentNode}return null}static finaAllParentsByMatch(e,t,r){let i=[];for(;e&&e.tagName!==null;)e.matches&&e.matches(t)&&i.push(e),e=e.parentNode;return r&&i.reverse(),i}static parentMatches(e,t){for(;e&&(e.tagName!==null||e===window);){for(let[r,i]of t.entries()){if(e===r)return[e,r,i];if(e.matches&&e.matches(r))return[e,r,i]}e=e.parentNode}return[null,null,[]]}static match(e,t){return e&&e.matches?e.matches(t):!1}static matches(e,t){if(e&&e.matches){for(let r in t)if(t.hasOwnProperty(r)&&e.matches(r))return[e,r,t[r]]}return[null,null,[]]}static swap(e,t,r){let i=e[t];e[t]=e[r],e[r]=i}static partition(e,t,r,i){let s=e[Math.floor((i+r)/2)][t],n=r,o=i;for(;n<=o;){for(;e[n][t]<s;)n++;for(;e[o][t]>s;)o--;n<=o&&(a.swap(e,n,o),n++,o--)}return n}static quickSort(e,t,r,i){let s;return e.length>1&&(r=typeof r!="number"?0:r,i=typeof i!="number"?e.length-1:i,s=this.partition(e,t,r,i),r<s-1&&a.quickSort(e,t,r,s-1),s<i&&a.quickSort(e,t,s,i)),e}};var v=class{static getQueryVariable(e,t){let i=window.location.search.substring(1).split("&"),s=[];for(let n=0;n<i.length;n++){let o=i[n].split("=");o[0]===e&&s.push(decodeURIComponent(o[1]))}return s.length===1&&!t?s[0]:s.length===0?"":s}};import"jquery";var P=a=>{},w=class{constructor(e){this.eventHandler=e,this.defaultEvent=this.eventHandler.defaultEvent,this.listeners=new Map}addListener(e,t){this.addListenerOnEvent(this.defaultEvent,e,t)}addNullListenerOnEvent(e,t){this.addListenerOnEvent(e,t,P)}addNullListener(e){this.addListener(e,P)}addWindowListener(e,t){this.addListenerOnEvent(e,window,t)}addListenerOnEvent(e,t,r){if(t instanceof HTMLElement){let i=t.getAttribute("data-maliceventid");i==null&&(i=`meid-${f.guid()}`,t.setAttribute("data-maliceventid",i)),t=`${t.tagName}[data-maliceventid=${i}]`}this.listeners.has(e)?this.listeners.get(e).has(t)?this.listeners.get(e).get(t).push(r):this.listeners.get(e).set(t,[r]):(this.listeners.set(e,new Map),this.listeners.get(e).set(t,[r])),this.eventHandler.listen(e)}clearListeners(e){this.clearListenersOnEvent(this.defaultEvent,e)}clearListenersOnEvent(e,t){this.listeners.has(e)&&this.listeners.get(e).has(t)&&this.listeners.get(e).delete(t)}trigger(e,t){this.triggerWithTarget(this.eventHandler.target[0],e,t)}triggerWithTarget(e,t,r){let i=new CustomEvent(t,{bubbles:!0,detail:r});e.dispatchEvent(i)}list(){let e=[];for(let[t,r]of this.listeners.entries()){e.push(`Event: ${t}`);for(let[i,s]of r.entries())e.push(i,s)}return e}logList(){console.log(this.list())}textList(){return this.list().join(`
`)}};var T=class extends w{constructor(e,t){super(e),this.groupName=t}};var c=class{constructor(e){this.defaultEvent=e.defaultEvent,this.elementHelper=f,this.defaultListenerCollection=new w(this),this.namedListenerCollections=new Map,this.debug=e.debug,e.loadingWarning?this.loadingWarning=e.loadingWarning:this.loadingWarning=()=>{this.debug&&console.log("Not quite ready! The page is currently loading and this function isn't quite read yet, please try again.")},this.target=$(e.target),this.eventProcessors=new Map}addListenerGroup(e){if(this.namedListenerCollections.has(e))return console.warn(`Named Listener Collection ${e} already exists`),this.namedListenerCollections.get(e);let t=new T(this,e);return this.namedListenerCollections.set(e,t),t}removeListenerGroup(e){this.namedListenerCollections.has(e)&&this.namedListenerCollections.delete(e)}enableDebug(){this.debug=!0}list(){console.log("Base Listeners:"),console.log(this.defaultListenerCollection.list()),console.log("Base Listener Collection:",this.defaultListenerCollection.list());for(let[e,t]of this.namedListenerCollections.entries())console.log(`Plugin Listeners [${e}]:`),console.log(t.list())}mergeListeners(...e){let t=new Map;for(let r of e)if(r)for(let i of r.entries())t.set(...i);return t}collateActiveListeners(e){let t=this.defaultListenerCollection.listeners.get(e),r=this.mergeListeners(t);for(let[i,s]of this.namedListenerCollections.entries()){let n=s.listeners.get(e);r=this.mergeListeners(r,n)}return r}listen(e){let t=r=>{this.debug&&console.log("HIGH LEVEL EVENT HANDLER firing on ",r);let i=r.target,s=$(i),n=!1;s.attr("href")==="#"&&(this.debug&&console.log("HIGH LEVEL EVENT HANDLER suppressing default for empty link ",r),r.preventDefault(),n=!0);let o=this.collateActiveListeners(e),d=this.elementHelper.parentMatches(i,o);if(d!==null&&d[0]!==null)$(d[2]).each((l,h)=>{this.debug&&(console.log(`HIGH LEVEL EVENT HANDLER action Index ${l}`),console.log("HIGH LEVEL EVENT HANDLER performing actions for ",d,r)),h(r,{el:i,$el:s,matchedEl:d[0],$matchedEl:$(d[0]),trigger:d[1],payload:r.detail})});else if(n){this.debug&&console.log("HIGH LEVEL EVENT HANDLER showing not loaded message on simple link ",r);let l=$._data(i,"events");(!l||!l.click)&&this.loadingWarning()}else this.debug&&console.log("HIGH LEVEL EVENT HANDLER taking no further action ",r)};this.eventProcessors.has(e)||(this.debug&&console.log(`Establish the listener for ${e} on ${this.target[0]}`),this.target[0].addEventListener(e,t),this.eventProcessors.set(e,t))}};import"jquery";var u=class extends c{constructor(e){e.defaultEvent=e.touchscreen?"touchstart":"click",super(e),this.touchscreen=e.touchscreen===!0}};import"jquery";var b=class extends c{constructor(e){e.defaultEvent="keyup",super(e)}};var S={target:window},x="default",A=class a{static create(){return window.eventHandlersMap||(window.eventHandlersMap=new Map),window.eventHandlersMap}static destroy(){delete window.eventHandlersMap}static addNamedHandlerOfType(e,t,r){let i=a.create();i.has(e)||i.set(e,new t(r))}static addDefaultHandlerOfType(e,t){a.addNamedHandlerOfType(x,e,t)}static addDefaultHandler(){a.addDefaultHandlerOfType(u,S)}static fetchHandler(e){let t=a.create();if(t.has(e))return t.get(e);throw"Requested namespace does not exist"}static fetchDefaultHandler(){return a.fetchHandler(x)}static dropHandlerOrCollection(e,t){t?a.fetchHandler(e).removeListenerGroup(t):window.eventHandlersMap.delete(e)}static dropCollection(e){a.dropHandlerOrCollection(x,e)}static fetchOrCreateListenerGroup(e,t,r,i){return a.addNamedHandlerOfType(e,t,r),i?a.fetchHandler(e).addListenerGroup(i):a.fetchListenerCollection(e,null)}static fetchListenerCollection(e,t){let r=a.fetchHandler(e);if(r)if(t!==null){if(r.namedListenerCollections().has(t))return r.namedListenerCollections.get(t)}else return r.defaultListenerCollection;throw"Requested namespace or collection group does not exist"}static fetchDefaultListenerCollectionFor(e){return a.fetchListenerCollection(e,null)}static fetchDefaultListenerCollection(){return a.fetchDefaultListenerCollectionFor(DEFAULT_NAMESPACE0)}},p=a=>A.fetchOrCreateListenerGroup(x,u,S,a),D=a=>{A.dropHandlerOrCollection(x,a)};var g=class{constructor(e){this.configure(e),this.hookEventListener(),this.elementHelper=f,this.requestParameters=v}configure(e){this.assimilate(e)}assimilate(e){U.extend(this,e)}hookEventListener(){this.eventHandler=p()}};var L=class extends g{constructor(e){super(e),this.configure(e)}trigger(e,t){let r=new CustomEvent(e,{detail:t});window.dispatchEvent(r)}on(e,t){window.addListener(e,t)}off(e){window.removeEventListener(e)}};import"jquery";import"jquery-ui";import B from"underscore";var W='<section id="<%- modal.id %>" class="<%- modal.class %> form modal" title="<%- modal.title %>"><div class="content"><%= modal.content %></div></section>',G=W;var H=class{constructor(e,t){this.actions=t,this.dialog=null,this.modalOptions=e;let r=$(B.template(G)({modal:this.modalOptions}));$("body").append(r);let i={autoOpen:!1,modal:!0,buttons:{Yes:function(){this.actions.yes&&this.actions.yes(),this.close()}.bind(this),No:function(){this.actions.no&&this.actions.no(),this.close()}.bind(this)},close:function(){}.bind(this)};i=B.extend(i,this.modalOptions),this.dialog=r.dialog(i)}open(){this.dialog.dialog("open")}close(){this.dialog.dialog("close"),this.modalOptions&&this.modalOptions.transient&&this.dialog.remove()}};import"jquery";import Y from"underscore";var F=class extends L{constructor(){super(),this.targetTableTimeouts={},this.targetTables=$("table.sortable"),this.paginationSelectorMatch="select.pagination-manager";let t=new URL(window.location.href).searchParams.get("page");t&&$(this.paginationSelectorMatch).val(t),this.addListeners()}addListeners(){this.targetTables.each((e,t)=>{this.targetTableTimeouts[e]=null;let r=$("#"+$(t).data("filterinput"));r.on("keydown",()=>{this.listenForFilter(r,t,e)}),this.sorter(t)})}sorter(e){let t=$(e),r=(i,s)=>n=>{let o=n.target,d=this.elementHelper.findParentTag(o,"TH");if(d&&d.hasClass("sortable")){let l=$(d);if(!l.hasClass("no-sorting")){let h="down";l.hasClass("down")&&(h="up"),s.find("thead th").removeClass("up"),s.find("thead th").removeClass("down"),l.addClass(h);let R=-1,O=0;for(let N of s.find("thead th"))if(!$(N).hasClass("no-data")){if(N===o){R=O;break}O++}this.sortTable(s,h,R)}}};t.find("thead th").on("click",r(e,t)),t.on("change",i=>{if(i.target.matches(this.paginationSelectorMatch)){let s=new URL(window.location.href);s.searchParams.set("page",$(i.target).val()),window.location.href=s.href}})}sortTable(e,t,r){let i=$(e.find("th")[r]),s=[],n=e.find("tr");n=n.filter((d,l)=>{let h=this.elementHelper.findParentTag(l,"TBODY");return this.elementHelper.findParentTag(l,"TABLE")===e[0]&&h!==null});for(let d=0;d<n.length;d++){let l=n[d].getElementsByTagName("TD")[r],h=$(l);i.hasClass("date-sortable")?s.push([d,h.data("datesorting")]):i.hasClass("alt-text")?s.push([d,h.data("alttext")]):i.hasClass("numeric")?s.push([d,parseInt(l.innerHTML.toLowerCase(),10)]):s.push([d,l?l.innerHTML.toLowerCase():""])}this.elementHelper.quickSort(s,1),t==="down"&&s.reverse();let o=[];if(n.length>0){let d=$(n[0].parentNode);for(let l=0;l<s.length;l++)o.push($(n[s[l][0]]).clone(!0));$(n).remove();for(let l=0;l<o.length;l++)d.append(o[l])}}listenForFilter(e,t,r){this.targetTableTimeouts[r]!==null&&clearTimeout(this.targetTableTimeouts[r]),this.targetTableTimeouts[r]=setTimeout(()=>{this.filter(t,e.val())},200)}filter(e,t){let i=$(e).find("tbody tr");t=t.toLowerCase(),i.removeClass("inline-data"),this.trigger("sortableTable.filter",{text:t}),Y.each(i,function(s){let n=$(s),o=n.find(".searchable");if(t){let d=!1;for(let l of o)if($(l).hasClass("alt-text")){let R=$(l).data("alttext");R&&R.toLowerCase().indexOf(t)>=0&&(d=!0)}o.text().toLowerCase().indexOf(t)>=0&&(d=!0),d||n.addClass("inline-data")}})}};import"jquery";import I from"underscore";var m=class{constructor(e){this.formElement=$(e.form),this.formDefaults=e.formDefaults!=null?e.formDefaults:{},this.autoHiddenReset=e.autoHiddenReset!=null?e.autoHiddenReset:!0,this.formSubmitRepression=e.formSubmitRepression!=null?e.formSubmitRepression:!0,this.inputRows=null,this.errorReference=null,this.inputReference=null,this.formLocked=!1,this.isDirty=!1,this.elementHelper=f,this.formEventGroupName=f.namespacedGuid("form"),this.eventHandler=p(this.formEventGroupName),this.formInitialPrepare(e)}formInitialPrepare(e){this.formBespokeSetup(e),this.configureFormAutocomplete(e),this.setupFormDataAndErrorHandling(e),this.formInteractivityInit(e)}formBespokeSetup(e){}trigger(e,t){t==null&&(t=null),this.eventHandler.triggerWithTarget(this.formElement[0],e,t)}on(e,t){this.eventHandler.addListenerOnEvent(e,this.formElement[0],t)}off(e){this.eventHandler.clearListenersOnEvent(e,this.formElement[0])}clearAllListeners(){D(this.formEventGroupName),this.formEventGroupName=f.guid(),this.eventHandler=p(this.formEventGroupName)}buildInputReference(e){let t={};return e.find("input,select,textarea").each(function(r,i){$(i).attr("type")!=="submit"&&(t[$(i).attr("name")]={tag:i.tagName,type:$(i).attr("type"),id:$(i).id})}.bind(this)),e.find("input[type=hidden]").each(function(r,i){t[$(i).attr("name")]={tag:i.tagName,type:$(i).attr("type"),id:$(i).attr("id")}}.bind(this)),e.find("div[contenteditable]").each(function(r,i){t[$(i).data("name")]={tag:i.tagName,type:"contenteditable",id:$(i).attr("id")}}.bind(this)),t}buildErrorReference(e){let t={};t.globalErrors=e.find(".global-errors");let r=e.find(".input-row");return r.each((i,s)=>{let n=$(s),o=n.data("errorname");t[o]=n}),{inputRows:r,errorReference:t}}configureFormAutocomplete(e){(!e||!e.enableAutoComplete)&&this.formElement.prop("autocomplete","off")}reconfigureInputs(){let e=this.buildErrorReference(this.formElement);this.errorReference=e.errorReference,this.inputRows=e.inputRows,this.inputReference=this.buildInputReference(this.formElement)}setupFormDataAndErrorHandling(e){this.reconfigureInputs(),this.formSubmitRepression&&(this.off("submit"),this.on("submit",t=>{t.preventDefault(),this.isLocked()||(this.lock(),this.trigger("form:submitted"))})),this.formElement.hasClass("formErrors")||this.reset(),this.on("click",t=>{let r=t.target;(this.elementHelper.match(r,"input")||this.elementHelper.match(r,"textarea")||this.elementHelper.match(r,"select")||this.elementHelper.match(r,"option"))&&(this.isDirty=!0)})}dirty(){return this.isDirty}makeClean(){this.isDirty=!1,this.extraTidyUp()}extraTidyUp(){}formInteractivityInit(e){}flashForm(){this.formElement.fadeTo(100,.3,function(){$(this).fadeTo(500,1)}),this.trigger("form:flashed")}emptyErrorsFromElement(e,t){t.find("div.error").empty(),e.find(".global-errors").empty(),t.removeClass("hasError"),e.removeClass("form-error")}emptyErrors(){this.emptyErrorsFromElement(this.formElement,this.inputRows)}resetExtensions(){}reset(){this.formElement[0].reset(),this.autoHiddenReset&&this.formElement.find("input[type=hidden]").each((e,t)=>{$(t).val("")}),this.isDirty=!1,this.emptyErrors(),this.resetExtensions(),this.setFormData(this.formDefaults),this.unlock(),this.trigger("form:reset")}errorExtensions(e){}addErrorsFromElement(e,t,r,i){if(this.emptyErrorsFromElement(t,r),e){if(t.addClass("formErrors"),e.global_errors){let s=e.global_errors.join("<br />");i.globalErrors.addClass("hasError"),i.globalErrors.html(s)}if(e.errors)for(let s in e.errors)e.errors.hasOwnProperty(s)&&this.addError(t,i,s,e.errors[s])}else i.globalErrors.addClass("hasError"),i.globalErrors.append("<p>An unexpected error has occurred</p>")}addErrors(e){this.addErrorsFromElement(e,this.formElement,this.inputRows,this.errorReference),e?this.errorExtensions(e):(this.errorReference.globalErrors.addClass("hasError"),this.errorReference.globalErrors.append("<p>An unexpected error has occurred</p>")),this.flashForm(),this.trigger("form:formErrors",e),this.unlock()}addError(e,t,r,i){e.addClass("formErrors");let s=t[r];s&&(s.addClass("hasError"),s.find("div.error").empty().append(i)),this.trigger("form:addError",r,i)}removeError(e,t){let r=e[t];r&&(r.removeClass("hasError"),r.find("div.error").empty())}setFormData(e,t){this.setFormDataFromElement(this.inputReference,this.formElement,this.formDefaults,this.dataIn(e),t)}setFormDataFromElement(e,t,r,i,s){let n={};r!=null&&(n=I.extend({},r)),n=I.extend(n,i);for(let o in n)n.hasOwnProperty(o)&&this.setFieldDataFromElement(o,e,t,n[o],s);s||this.trigger("form:setFormData",n)}setFieldData(e,t,r){this.setFieldDataFromElement(e,this.inputReference,this.formElement,t,r)}setFieldDataFromElement(e,t,r,i,s){let n=t[e];if(n){let o=r.find(n.tag+"[name="+e+"]");switch(n.tag){case"INPUT":switch(n.type){case"checkbox":Array.isArray(i)?o.each(function(d,l){let h=$(l);I.contains(i,""+h.val())?h.prop("checked",!0):h.prop("checked",!1)}):i?o.prop("checked",!0):o.prop("checked",!1);break;case"text":o.val(i);break;case"radio":o.each(function(d,l){let h=$(l);I.contains(i,""+h.val())||i===""+h.val()?h.prop("checked",!0):h.prop("checked",!1)});break;default:o.val(i);break}break;case"SELECT":o.val(i);break;case"TEXTAREA":o.val(i);break;case"DIV":o.text(i);break;default:o.val(i);break}}s||this.trigger("form:setFieldData",{fieldName:e,value:i})}getFieldDataFromElement(e,t,r){let i=t[e];if(i){let s=r.find(i.tag+"[name="+e+"]");switch(i.tag){case"INPUT":switch(i.type){case"checkbox":let n;return s.attr("data-disposition")==="singular"?s.attr("value")?n=s.val():n=!!s[0].checked:(n=[],s.each(function(d,l){l.checked&&n.push($(l).val())})),n;case"text":return s.val();case"radio":let o=null;return s.each(function(d,l){l.checked&&(o=$(l).val())}),o;default:return s.val()}break;case"SELECT":return s.val();case"TEXTAREA":return s.val();case"DIV":return s.html();default:return s.val()}}}getFieldData(e){return this.getFieldDataFromElement(e,this.inputReference,this.formElement)}getFormData(){let e={};for(let t in this.inputReference)e[t]=this.getFieldData(t);return this.dataOut(e)}dataIn(e){return e}dataOut(e){return e}isLocked(){return this.formLocked}lock(){this.formLocked=!0,this.trigger("form:locked")}unlock(){this.formLocked=!1,this.trigger("form:unlocked")}disableFields(e){$(e).each(function(t,r){$(r).prop("disabled",!0)})}enableFields(e){$(e).each(function(t,r){$(r).prop("disabled",!1)})}yesOrNoToBoolean(e,t,r){e[r]&&e[r]==="yes"?t[r]=!0:t[r]=!1}booleanToYesOrNo(e,t,r){e[r]?t[r]=["yes"]:t[r]=["no"]}onOrOffToBoolean(e,t,r){e[r]&&e[r][0]==="on"?t[r]=!0:t[r]=!1}};var C=class extends m{constructor(e){super(e)}formInteractivityInit(){}dataIn(e){return e}dataOut(e){return e}};import"jquery";import j from"underscore";var E=class extends m{constructor(e){super(e)}formInitialPrepare(e){this.formBespokeSetup(e),this.configureFormAutocomplete(e),this.generators=[],this.generatorAdd(),this.setupFormDataAndErrorHandling(e),this.on("form:reset",t=>{console.log("RESET GENERATORS"),$(this.generators).each((r,i)=>{i.generatorRowStore.empty()})}),this.formInteractivityInit(e)}unescapeTemplate(e){let t=document.createElement("textarea");t.innerHTML=e;let r=t.childNodes.length===0?"":t.childNodes[0].nodeValue;return $(t).remove(),r}generatorAdd(){let e=this.formElement.find(".generator");$(e).each((t,r)=>{let i=$(r),s=this.unescapeTemplate(i.data("template")),n=f.guid();i.attr("data-generatedid",n);let o={generator:i,generatorId:n,generatorRowStore:i.find(".generator_rows"),generatorIndex:t,templateRow:j.template(s)};this.generators.push(o),this.eventHandler.addListener(`.generator[data-generatedid="${n}"] button`,(d,l)=>{d.preventDefault(),this.generatorHandler(o,l.matchedEl)})})}generatorHandler(e,t){t.matches("button.add-row")?this.generatorAddRowButtonHandler(e,t,this.elementHelper.guid()):t.matches("button.delete-row")?this.generatorDeleteRowButtonHandler(e,t):this.generatorOtherButtonHandler(e,t)}generatorAddRowButtonHandler(e,t,r){e.generatorRowStore.append(e.templateRow({id:r}))}generatorDeleteRowButtonHandler(e,t){let r=this.elementHelper.findParentByMatch(t,"div.generator-input-row");r!==null&&$(r).remove()}generatorOtherButtonHandler(e,t){}addErrors(e){this.addErrorsFromElement(e,this.formElement,this.inputRows,this.errorReference),$(this.generators).each((t,r)=>{let i=this.buildErrorReference(r.generator);this.addErrorsFromElement(e,r.generator,i.inputRows,i.errorReference)}),e?this.errorExtensions(e):(this.errorReference.globalErrors.addClass("hasError"),this.errorReference.globalErrors.append("<p>An unexpected error has occurred</p>")),this.flashForm(),this.trigger("form:formErrors",e),this.unlock()}emptyErrors(){this.emptyErrorsFromElement(this.formElement,this.inputRows),$(this.generators).each((e,t)=>{let r=this.buildErrorReference(t.generator);this.emptyErrorsFromElement(t.generator,r.inputRows)})}findInCollation(e,t,r,i,s){let n=null;t.hasOwnProperty(s)?n=t[s]:(e.push(s),n={}),n.id=s,n[r]=i,t[s]=n}collateGenerator(e){let t=this.buildInputReference(e.generator),r=[],i={},s=[];for(let n in t){let o=n.split("_"),d=o[o.length-1],l=o.slice(0,o.length-1).join("_"),h=this.getFieldDataFromElement(n,t,e.generator);this.findInCollation(r,i,l,h,d)}return $(r).each((n,o)=>{s.push(i[o])}),s}populateGenerator(e,t){let r={};$(t).each(function(s,n){this.generatorAddRowButtonHandler(e,null,n.id);for(let o in n)n.hasOwnProperty(o)&&(r[o+"_"+n.id]=n[o])}.bind(this));let i=this.buildInputReference(e.generator);this.setFormDataFromElement(i,e.generatorRowStore,{},r,!0)}};var y=class extends E{constructor(e){super(e)}formInteractivityInit(){}generatorRowOtherHandler(e,t){}dataIn(e){return e}dataOut(e){return e}};var k=class{static viewCheckerAndFormatter(e,t,r){let i=[];for(let s of t)e[s]&&i.push({view:e[s],label:s,options:r});return i}constructor(e){if(!(e instanceof Object))throw new Error("You must specify a configuration object when creating a Dispatcher");if(e.viewPath===void 0)throw new Error("You must specify a viewPath in your Dispatcher constructor, these may be null");this.eventGroupId=f.namespacedGuid("dispatcher"),this.eventHandler=p(this.eventGroupId),this.target=document.createElement("script",{id:this.eventGroupId}),document.body.append(this.target),this.viewPath=e.viewPath,this.instantiatedViews={},this.failedViews={},this.viewList=[]}trigger(e,t){this.eventHandler.triggerWithTarget(this.target,e,t)}on(e,t){this.eventHandler.addListenerOnEvent(e,this.target,t)}requireAndInstantiate(e,t,r,i){import(`${e}${t}`).then(s=>{this.instantiatedViews[r]=new s.default(i),this.trigger("dispatcher:viewloaded",r)}).catch(s=>{throw this.failedViews[r]=i,this.trigger("dispatcher:viewfailed",r),s})}requireAndInstantiateView(e,t,r){this.requireAndInstantiate(this.viewPath,e,t,r)}requireAndInstantiateViews(e){this.viewList=e;let t={},r=[];this.on("dispatcher:viewloaded",(i,s)=>{let n=s.payload;t[n]=!0;for(let o of r)if(!t[o])return;this.trigger("dispatcher:allviewsloaded",e)});for(let i of this.viewList)t[i.label]=!1,r.push(i.label),this.requireAndInstantiateView(i.view,i.label,i.options)}};var X={ElementHelper:f},Q={HighLevelEventHandler:u},z={ConfirmationModal:H},J={RequestParameters:v},Z={BaseClass:g},_={dom:X,events:Q,modal:z,request:J,classes:Z},M=_;import K from"underscore";import"jquery";var ee=K.template("<style><%- css %></style>"),te=function(a){window&&document&&fetch(a).then(e=>{e.text().then(t=>{let i=ee({css:t});$("head").append(i)})})},re=function(a){return new URL(import.meta.url).pathname.replace("index.js",a)},V=function(){te(re("./forms/forms.css"))};var ie={formsCSS:V},q=ie;var se={ConfirmationModal:H,SortableTable:F,ElementHelper:f,BaseHighLevelEventHandler:c,HighLevelEventHandler:u,HighLevelKeyPressEventHandler:b,handler:p,dropHandler:D,FormHandler:m,BaseClass:g,ListeningClass:L,BasicForm:C,FormHandlerWithGenerators:E,BasicFormWithGenerators:y,Dispatcher:k,helpers:M,css:q},It=se;export{g as BaseClass,c as BaseHighLevelEventHandler,C as BasicForm,y as BasicFormWithGenerators,H as ConfirmationModal,k as Dispatcher,f as ElementHelper,m as FormHandler,E as FormHandlerWithGenerators,u as HighLevelEventHandler,b as HighLevelKeyPressEventHandler,L as ListeningClass,F as SortableTable,q as css,It as default,D as dropHandler,p as handler,M as helpers};
//# sourceMappingURL=index.js.map
